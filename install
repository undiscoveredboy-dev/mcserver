#!/bin/bash

set -e

mkdir -p bin
chmod +x *

export MAIN_DIR="$PWD"

echo "Which Server do you want to install?"
echo "Type [1] Java Server"
echo "Type [2] Bedrock Server"
read -r choiceForServer

# -----------------------------
# Install Oracle JDK 21
# -----------------------------
JDK_URL="https://download.oracle.com/java/21/latest/jdk-21_linux-x64_bin.deb"

echo "> Downloading Java JDK 21..."
wget -q "$JDK_URL" -O bin/java.deb

cd "$MAIN_DIR/bin"
echo "> Installing Java JDK 21..."
sudo dpkg -i java.deb || sudo apt -f install -y

cd "$MAIN_DIR"

# -----------------------------
# Server choice
# -----------------------------
if [[ -z "$choiceForServer" ]]; then
  echo "> Invalid response"
  ./install

elif [[ "$choiceForServer" == "1" ]]; then
  echo "> Running Java installation..."
  ./installJava

elif [[ "$choiceForServer" == "2" ]]; then
  echo "> Running Bedrock installation..."
  ./installBedrock

else
  echo "> Invalid response"
  ./install
fi

# -----------------------------
# AFK / Monitor tool
# -----------------------------
echo "> Installing AFK monitor..."
python3 -m pip install --user bpytop

echo "> Install finished."
