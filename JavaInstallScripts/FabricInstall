echo -e '\n> Enter Minecraft version (leave blank for latest stable version): '
read MC_VERSION

# Determine the Minecraft version to use
if [ -z "$MC_VERSION" ]; then
  MC_VERSION=$(curl -sSL https://meta.fabricmc.net/v2/versions/game | jq -r '.[] | select(.stable == true) | .version' | head -n1)
  echo -e "No version entered. Using latest stable version: $MC_VERSION"
else
  echo -e "Using specified Minecraft version: $MC_VERSION"
fi

# Determine the latest Fabric installer version
FABRIC_INSTALLER_VERSION=$(curl -sSL https://meta.fabricmc.net/v2/versions/installer | jq -r '.[0].version')

# Download the Fabric installer
wget -O fabric-installer.jar "https://maven.fabricmc.net/net/fabricmc/fabric-installer/$FABRIC_INSTALLER_VERSION/fabric-installer-$FABRIC_INSTALLER_VERSION.jar"

# Run the Fabric installer to set up the server
java -jar fabric-installer.jar server -mcversion "$MC_VERSION" -downloadMinecraft

# Automatically accept the Minecraft EULA
echo "eula=true" > eula.txt

# Create a script to start the server
echo -e "#!/bin/bash\njava -Xmx2G -Xms1G -jar fabric-server-launch.jar nogui" > start.sh
chmod +x start.sh

# Confirm completion
echo -e "Fabric server installation complete for Minecraft version $MC_VERSION"
echo -e "To start the server, run ./start.sh in the ~/minecraft-server directory."
